MONGODB TO FIREBASE/FIRESTORE MIGRATION - STEP BY STEP CHECKLIST

================================================================================
PRE-MIGRATION CHECKLIST
================================================================================

FIREBASE PROJECT SETUP:
[ ] Created Firebase project at console.firebase.google.com
[ ] Enabled Firestore Database
[ ] Downloaded serviceAccountKey.json
[ ] Placed serviceAccountKey.json in backend/ folder
[ ] Got Firebase web app configuration (for frontend)
[ ] Selected Firestore location/region

BACKEND PREPARATION:
[ ] Backed up existing MongoDB data (if you want to keep it)
[ ] Have Excel files ready for import (authorized members and information)
[ ] Generated strong JWT_SECRET
[ ] Prepared admin account credentials
[ ] Configured email service (Gmail app password or SMTP)

================================================================================
MIGRATION STEPS
================================================================================

STEP 1: BACKEND DEPENDENCIES
[ ] cd backend
[ ] npm uninstall mongoose
[ ] npm install firebase-admin
[ ] npm install
[ ] Verify package.json has firebase-admin dependency

STEP 2: ENVIRONMENT CONFIGURATION
[ ] Created backend/.env file from backend/.env.example
[ ] Set JWT_SECRET (use: node -e "console.log(require('crypto').randomBytes(32).toString('hex'))")
[ ] Set ADMIN_EMAIL and ADMIN_PASSWORD
[ ] Set FRONTEND_URL
[ ] Set EMAIL_* variables (for password reset)
[ ] Verified serviceAccountKey.json is in backend/ folder

STEP 3: DEPLOY FIRESTORE SECURITY RULES
Option A - Firebase CLI:
[ ] npm install -g firebase-tools
[ ] firebase login
[ ] cd backend
[ ] firebase init firestore (select your project)
[ ] firebase deploy --only firestore:rules

Option B - Manual:
[ ] Opened Firebase Console > Firestore > Rules
[ ] Copied content from backend/firestore.rules
[ ] Pasted and published

STEP 4: START BACKEND SERVER
[ ] cd backend
[ ] npm run dev
[ ] Verified "Firebase Admin SDK initialized" message
[ ] Verified "Firestore database connected" message
[ ] Tested: http://localhost:3001/api/health (should return success)

STEP 5: CREATE ADMIN USER
[ ] Admin automatically created on startup (if ENABLE_ADMIN_BOOTSTRAP=true)
[ ] OR run manually: npm run bootstrap-admin
[ ] Noted admin credentials from .env file
[ ] Tested admin login at frontend

STEP 6: IMPORT DATA
Import Authorized Members:
[ ] Prepared Excel file with columns: memberId, phoneNumber, name, email
[ ] Placed file in backend/ folder
[ ] cd backend
[ ] npm run import-members your-file.xlsx
[ ] Verified import count matches Excel rows
[ ] Checked Firebase Console > Firestore > authorizedMembers collection

Import Information Data:
[ ] Prepared Excel file with columns: Member_Id, First name, middle name, Last Name, number
[ ] Placed file in backend/ folder
[ ] cd backend
[ ] npm run import-info your-file.xlsx
[ ] Verified import count
[ ] Checked Firebase Console > Firestore > information collection

STEP 7: FRONTEND CONFIGURATION
[ ] Verified MyExpoApp/firebaseConfig.ts has correct Firebase config
   Current config shows:
   - projectId: samaj-app-a3de3
   - Already configured correctly
[ ] Checked MyExpoApp/config/api.ts for correct BASE_URL
[ ] cd MyExpoApp
[ ] npm install
[ ] npm start

STEP 8: VERIFY EVERYTHING WORKS
User Features:
[ ] Signup with valid memberId and phone (should be verified automatically)
[ ] Signup with invalid credentials (should require admin approval)
[ ] Login with created account
[ ] Access dashboard
[ ] Create family tree entry
[ ] Edit family tree entry
[ ] Delete family tree entry
[ ] Search information
[ ] View committee members
[ ] View sponsors
[ ] View events
[ ] View offers
[ ] View spiritual places

Admin Features:
[ ] Login with admin credentials
[ ] Access admin dashboard (see statistics)
[ ] View all users
[ ] View pending users
[ ] Approve a pending user
[ ] Reject a pending user
[ ] View authorized members list
[ ] Create committee member
[ ] Edit committee member
[ ] Delete committee member
[ ] Create sponsor (same for offers, events, places)
[ ] Upload image for content (if applicable)

Auth Features:
[ ] Test forgot password flow
[ ] Receive password reset email
[ ] Reset password with token
[ ] Login with new password
[ ] Get current user (GET /api/auth/me)

STEP 9: FIRESTORE DATA VERIFICATION
Check in Firebase Console > Firestore Database:
[ ] users collection has admin user
[ ] authorizedMembers collection has imported data
[ ] information collection has imported data
[ ] familyTree collection (will populate as users add entries)
[ ] committeeMembers collection (will populate as admin adds)
[ ] sponsors collection
[ ] specialOffers collection
[ ] upcomingEvents collection
[ ] spiritualPlaces collection

STEP 10: CLEANUP
[ ] Removed backend/config/db.js
[ ] Removed backend/models/ folder (all Mongoose models)
[ ] Verified mongoose is not in package.json dependencies
[ ] Verified no MongoDB references in code
[ ] Updated .gitignore (already configured)

================================================================================
POST-MIGRATION CHECKLIST
================================================================================

SECURITY:
[ ] serviceAccountKey.json is NOT committed to git
[ ] .env file is NOT committed to git
[ ] Changed admin password after first login
[ ] Using strong JWT_SECRET (different from example)
[ ] Firestore security rules are deployed
[ ] Email service is configured and working

TESTING:
[ ] All API endpoints work
[ ] Signup/Login flow works
[ ] Password reset works
[ ] Admin panel accessible
[ ] Family tree CRUD works
[ ] Content management works
[ ] Information search works
[ ] File uploads work (if applicable)
[ ] Mobile app works
[ ] Web app works

DOCUMENTATION:
[ ] Read FIREBASE_MIGRATION_GUIDE.txt
[ ] Read QUICK_COMMANDS.txt
[ ] Team members know how to run the app
[ ] Admin knows how to manage users
[ ] Admin knows how to import data

PRODUCTION READINESS:
[ ] Updated NODE_ENV=production in production .env
[ ] Set strong production JWT_SECRET
[ ] Set correct FRONTEND_URL for production
[ ] Disabled ENABLE_ADMIN_BOOTSTRAP in production
[ ] Configured proper email service
[ ] Tested all features in production environment
[ ] Set up Firebase billing alerts
[ ] Set up monitoring
[ ] Set up backups

================================================================================
TROUBLESHOOTING CHECKLIST
================================================================================

IF SERVER WON'T START:
[ ] serviceAccountKey.json is in backend/ folder
[ ] JWT_SECRET is set in .env
[ ] All dependencies installed (npm install)
[ ] Port 3001 is not in use
[ ] No syntax errors in code

IF AUTHENTICATION FAILS:
[ ] User exists in Firestore
[ ] Password is correct
[ ] User accountStatus is "approved"
[ ] JWT_SECRET matches between requests
[ ] Token is being sent in Authorization header

IF FIRESTORE PERMISSION DENIED:
[ ] Security rules are deployed
[ ] User is authenticated
[ ] User has required role (admin for admin routes)

IF IMPORT FAILS:
[ ] Excel file path is correct
[ ] Excel file has required columns
[ ] Column names match expected variations
[ ] At least memberId or phoneNumber exists

IF EMAIL NOT SENT:
[ ] EMAIL_* variables are set in .env
[ ] Using app-specific password for Gmail
[ ] SMTP settings are correct
[ ] Email service allows less secure apps / app passwords

IF FRONTEND CAN'T CONNECT:
[ ] Backend is running on port 3001
[ ] FRONTEND_URL in backend .env matches frontend URL
[ ] BASE_URL in MyExpoApp/config/api.ts is correct
[ ] CORS is enabled (already configured)

================================================================================
VERIFICATION COMMANDS
================================================================================

# Check if backend is running
curl http://localhost:3001/api/health

# Or in PowerShell
Invoke-WebRequest -Uri http://localhost:3001/api/health

# Check Firestore collections
firebase firestore:stats

# Check npm packages
cd backend
npm list firebase-admin mongoose

# Should show firebase-admin and NO mongoose

# Verify .env exists
cd backend
Test-Path .env

# Should return: True

# Verify serviceAccountKey.json exists
cd backend
Test-Path serviceAccountKey.json

# Should return: True

================================================================================
ROLLBACK PLAN (IF NEEDED)
================================================================================

IF YOU NEED TO ROLLBACK TO MONGODB:

1. Restore from git:
   git checkout HEAD -- backend/

2. Reinstall MongoDB dependencies:
   cd backend
   npm install mongoose
   npm uninstall firebase-admin

3. Restore .env with MONGODB_URI

4. Start MongoDB server

5. Restart backend:
   npm run dev

NOTE: It's recommended to create a git branch before migration:
git checkout -b firebase-migration

This allows easy rollback:
git checkout main

================================================================================
SUCCESS INDICATORS
================================================================================

YOU KNOW MIGRATION IS SUCCESSFUL WHEN:

âœ… Backend starts without errors
âœ… Firebase Admin SDK initialized message appears
âœ… Firestore database connected message appears
âœ… Admin user can login
âœ… Normal users can signup and login
âœ… Family tree CRUD operations work
âœ… Admin panel is accessible
âœ… All content management works
âœ… Password reset emails are sent
âœ… Data imports successfully
âœ… No MongoDB references in console logs
âœ… Firebase Console shows data in Firestore
âœ… Mobile/web app works end-to-end

================================================================================
COMPLETION STATUS
================================================================================

Migration Status: [ ] Not Started  [ ] In Progress  [ ] Completed

Date Started: _______________
Date Completed: _______________

Migrated By: _______________

Notes:
_____________________________________________________________________________
_____________________________________________________________________________
_____________________________________________________________________________
_____________________________________________________________________________

================================================================================
NEXT STEPS AFTER MIGRATION
================================================================================

1. Train team members on new Firebase setup
2. Document any custom configurations
3. Set up monitoring and alerts
4. Plan regular backups
5. Review Firebase billing and usage
6. Optimize Firestore indexes if needed
7. Consider Firebase Functions for additional features
8. Review and update security rules periodically
9. Test disaster recovery procedures
10. Celebrate successful migration! ðŸŽ‰

================================================================================
END OF CHECKLIST
================================================================================
